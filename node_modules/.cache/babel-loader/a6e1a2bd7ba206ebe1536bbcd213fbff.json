{"ast":null,"code":"var _jsxFileName = \"D:\\\\ionic uas\\\\Pencari_Mutual_APP\\\\src\\\\pages\\\\Register\\\\Register.tsx\",\n    _s = $RefreshSig$();\n\nimport { IonButton, IonContent, IonInput, IonItem, IonLabel, IonPage, IonTitle } from \"@ionic/react\";\nimport \"./Register.css\";\nimport firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport \"firebase/auth\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport { setUser } from \"../../store/action\";\nimport swal from \"sweetalert2\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst profilePic = \"https://image.flaticon.com/icons/png/512/1177/1177568.png\";\n\nconst bcrypt = require(\"bcryptjs\");\n\nif (!firebase.apps.length) {\n  firebase.initializeApp({\n    apiKey: \"AIzaSyBOkpGmYEhzvH2WEVtc0ZN5A15iTDSjPMg\",\n    authDomain: \"pencari-mutual.firebaseapp.com\",\n    projectId: \"pencari-mutual\",\n    storageBucket: \"pencari-mutual.appspot.com\",\n    messagingSenderId: \"143095555281\",\n    appId: \"1:143095555281:web:6104f111e09270ea53d1f0\",\n    measurementId: \"G-CF723V5FEL\"\n  });\n} else {\n  firebase.app(); // kalau udah ada, pakai yang ini\n}\n\nconst auth = firebase.auth();\nconst firestore = firebase.firestore();\n\nconst Register = () => {\n  _s();\n\n  let [email, setEmail] = useState();\n  let [password, setPassword] = useState();\n  const [repeatPassword, setRepeatPassword] = useState();\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  async function signUp() {\n    const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n    if (!email) {\n      swal.fire(`email cannot empty`);\n    } else if (!re.test(String(email).toLowerCase())) {\n      swal.fire(`invalid email format`);\n    } else if (!password) {\n      swal.fire(`password required`);\n    } else if (password !== repeatPassword) {\n      swal.fire(`repeat password not same`);\n    } else {\n      const userRef = firestore.collection(\"users\").doc(email);\n      const doc = await userRef.get();\n\n      if (doc.exists) {\n        swal.fire(`Email already registered`);\n      } else {\n        const userRef = firestore.collection(\"users\");\n        password = bcrypt.hashSync(password, 10);\n        userRef.doc(email).set({\n          email,\n          password,\n          profilePic\n        });\n        swal.fire(`Congratulation!`, `Sign up succeed`, `success`);\n        history.push(\"/login\");\n      }\n    }\n\n    document.getElementById(\"input-email\").value = \"\";\n    document.getElementById(\"input-password\").value = \"\";\n    document.getElementById(\"input-repeat-password\").value = \"\";\n  }\n\n  function signInWithGoogle() {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    auth.signInWithPopup(provider).then(data => {\n      var _data$additionalUserI;\n\n      if ((_data$additionalUserI = data.additionalUserInfo) === null || _data$additionalUserI === void 0 ? void 0 : _data$additionalUserI.isNewUser) {\n        var _data$user, _data$user2, _data$user3, _data$user4, _data$user5, _data$user6, _data$user7;\n\n        const userRef = firestore.collection(\"users\");\n        const password = bcrypt.hashSync((_data$user = data.user) === null || _data$user === void 0 ? void 0 : _data$user.uid, 10);\n        const email = ((_data$user2 = data.user) === null || _data$user2 === void 0 ? void 0 : _data$user2.email) || undefined;\n        userRef.doc(email).set({\n          email,\n          password,\n          profilePic: (_data$user3 = data.user) === null || _data$user3 === void 0 ? void 0 : _data$user3.photoURL,\n          name: (_data$user4 = data.user) === null || _data$user4 === void 0 ? void 0 : _data$user4.displayName\n        });\n        dispatch(setUser({\n          name: (_data$user5 = data.user) === null || _data$user5 === void 0 ? void 0 : _data$user5.displayName,\n          email: (_data$user6 = data.user) === null || _data$user6 === void 0 ? void 0 : _data$user6.email,\n          profilePic: (_data$user7 = data.user) === null || _data$user7 === void 0 ? void 0 : _data$user7.photoURL\n        }));\n        history.push(\"/\");\n      } else {\n        var _data$user8;\n\n        const email = ((_data$user8 = data.user) === null || _data$user8 === void 0 ? void 0 : _data$user8.email) || undefined;\n        const userRef = firestore.collection(\"users\");\n        const doc = userRef.doc(email).get();\n        const user = doc.then(data => {\n          dispatch(setUser(data.data()));\n          history.push(\"/\");\n        });\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(IonPage, {\n    children: /*#__PURE__*/_jsxDEV(IonContent, {\n      children: /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"register-section\",\n        children: [/*#__PURE__*/_jsxDEV(IonItem, {\n          class: \"content\",\n          lines: \"full\",\n          children: /*#__PURE__*/_jsxDEV(IonTitle, {\n            class: \"title\",\n            children: \"Create Account,\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          lines: \"none\",\n          children: /*#__PURE__*/_jsxDEV(IonLabel, {\n            class: \"sub-title\",\n            children: \" Sign up to get started!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          lines: \"none\",\n          children: /*#__PURE__*/_jsxDEV(IonInput, {\n            onIonInput: e => setEmail(e.target.value),\n            id: \"input-email\",\n            type: \"email\",\n            placeholder: \"Input email address\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          lines: \"none\",\n          children: /*#__PURE__*/_jsxDEV(IonInput, {\n            onIonInput: e => setPassword(e.target.value),\n            id: \"input-password\",\n            type: \"password\",\n            placeholder: \"Input password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          lines: \"none\",\n          children: /*#__PURE__*/_jsxDEV(IonInput, {\n            onIonInput: e => setRepeatPassword(e.target.value),\n            id: \"input-repeat-password\",\n            type: \"password\",\n            placeholder: \"Repeat password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          lines: \"none\",\n          children: /*#__PURE__*/_jsxDEV(IonButton, {\n            className: \"button-register\",\n            onClick: signUp,\n            class: \"button\",\n            children: \"Sign Up\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          lines: \"none\",\n          children: /*#__PURE__*/_jsxDEV(IonButton, {\n            className: \"button-register\",\n            color: \"tertiary\",\n            onClick: signInWithGoogle,\n            children: \"Connect With Google\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          lines: \"none\",\n          children: /*#__PURE__*/_jsxDEV(IonLabel, {\n            class: \"to-login\",\n            children: [\"Already have account? \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"/login\",\n              children: \"Login Here\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Register, \"isrO1BYslu+nmo6E1D/ZTjYgGTQ=\", false, function () {\n  return [useDispatch, useHistory];\n});\n\n_c = Register;\nexport default Register;\n\nvar _c;\n\n$RefreshReg$(_c, \"Register\");","map":{"version":3,"sources":["D:/ionic uas/Pencari_Mutual_APP/src/pages/Register/Register.tsx"],"names":["IonButton","IonContent","IonInput","IonItem","IonLabel","IonPage","IonTitle","firebase","useState","useDispatch","useHistory","setUser","swal","profilePic","bcrypt","require","apps","length","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","auth","firestore","Register","email","setEmail","password","setPassword","repeatPassword","setRepeatPassword","dispatch","history","signUp","re","fire","test","String","toLowerCase","userRef","collection","doc","get","exists","hashSync","set","push","document","getElementById","value","signInWithGoogle","provider","GoogleAuthProvider","signInWithPopup","then","data","additionalUserInfo","isNewUser","user","uid","undefined","photoURL","name","displayName","e","target"],"mappings":"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","sourcesContent":["import {\r\n  IonButton,\r\n  IonContent,\r\n  IonHeader,\r\n  IonInput,\r\n  IonItem,\r\n  IonLabel,\r\n  IonPage,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport \"./Register.css\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/firestore\";\r\nimport \"firebase/auth\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useHistory } from \"react-router\";\r\nimport { setUser } from \"../../store/action\";\r\nimport swal from \"sweetalert2\";\r\nconst profilePic = \"https://image.flaticon.com/icons/png/512/1177/1177568.png\";\r\nconst bcrypt = require(\"bcryptjs\");\r\n\r\nif (!firebase.apps.length) {\r\n  firebase.initializeApp({\r\n    apiKey: \"AIzaSyBOkpGmYEhzvH2WEVtc0ZN5A15iTDSjPMg\",\r\n    authDomain: \"pencari-mutual.firebaseapp.com\",\r\n    projectId: \"pencari-mutual\",\r\n    storageBucket: \"pencari-mutual.appspot.com\",\r\n    messagingSenderId: \"143095555281\",\r\n    appId: \"1:143095555281:web:6104f111e09270ea53d1f0\",\r\n    measurementId: \"G-CF723V5FEL\"\r\n  });\r\n} else {\r\n  firebase.app(); // kalau udah ada, pakai yang ini\r\n}\r\n\r\nconst auth = firebase.auth();\r\nconst firestore = firebase.firestore();\r\n\r\nconst Register: React.FC = () => {\r\n  let [email, setEmail] = useState();\r\n  let [password, setPassword] = useState();\r\n  const [repeatPassword, setRepeatPassword] = useState();\r\n\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n\r\n  async function signUp() {\r\n    const re =\r\n      /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    if (!email) {\r\n      swal.fire(`email cannot empty`);\r\n    } else if (!re.test(String(email).toLowerCase())) {\r\n      swal.fire(`invalid email format`);\r\n    } else if (!password) {\r\n      swal.fire(`password required`);\r\n    } else if (password !== repeatPassword) {\r\n      swal.fire(`repeat password not same`);\r\n    } else {\r\n      const userRef = firestore.collection(\"users\").doc(email);\r\n      const doc = await userRef.get();\r\n      if (doc.exists) {\r\n        swal.fire(`Email already registered`);\r\n      } else {\r\n        const userRef = firestore.collection(\"users\");\r\n        password = bcrypt.hashSync(password, 10);\r\n        userRef.doc(email).set({ email, password, profilePic });\r\n        swal.fire(`Congratulation!`, `Sign up succeed`, `success`);\r\n        history.push(\"/login\");\r\n      }\r\n    }\r\n    (document.getElementById(\"input-email\") as HTMLInputElement).value = \"\";\r\n    (document.getElementById(\"input-password\") as HTMLInputElement).value = \"\";\r\n    (\r\n      document.getElementById(\"input-repeat-password\") as HTMLInputElement\r\n    ).value = \"\";\r\n  }\r\n\r\n  function signInWithGoogle() {\r\n    const provider = new firebase.auth.GoogleAuthProvider();\r\n    auth.signInWithPopup(provider).then((data) => {\r\n      if (data.additionalUserInfo?.isNewUser) {\r\n        const userRef = firestore.collection(\"users\");\r\n        const password = bcrypt.hashSync(data.user?.uid, 10);\r\n        const email = data.user?.email || undefined;\r\n        userRef.doc(email).set({\r\n          email,\r\n          password,\r\n          profilePic: data.user?.photoURL,\r\n          name: data.user?.displayName,\r\n        });\r\n        dispatch(\r\n          setUser({\r\n            name: data.user?.displayName,\r\n            email: data.user?.email,\r\n            profilePic: data.user?.photoURL,\r\n          })\r\n        );\r\n        history.push(\"/\");\r\n      } else {\r\n        const email = data.user?.email || undefined;\r\n        const userRef = firestore.collection(\"users\");\r\n        const doc = userRef.doc(email).get();\r\n        const user = doc.then((data) => {\r\n          dispatch(setUser(data.data()));\r\n          history.push(\"/\");\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonContent>\r\n        <section className=\"register-section\">\r\n          <IonItem class=\"content\" lines=\"full\">\r\n            <IonTitle class=\"title\">Create Account,</IonTitle>\r\n          </IonItem>\r\n          <IonItem lines=\"none\">\r\n            <IonLabel class=\"sub-title\"> Sign up to get started!</IonLabel>\r\n          </IonItem>\r\n          <IonItem lines=\"none\">\r\n            <IonInput\r\n              onIonInput={(e: any) => setEmail(e.target.value)}\r\n              id=\"input-email\"\r\n              type=\"email\"\r\n              placeholder=\"Input email address\"\r\n            ></IonInput>\r\n          </IonItem>\r\n          <IonItem lines=\"none\">\r\n            <IonInput\r\n              onIonInput={(e: any) => setPassword(e.target.value)}\r\n              id=\"input-password\"\r\n              type=\"password\"\r\n              placeholder=\"Input password\"\r\n            ></IonInput>\r\n          </IonItem>\r\n          <IonItem lines=\"none\">\r\n            <IonInput\r\n              onIonInput={(e: any) => setRepeatPassword(e.target.value)}\r\n              id=\"input-repeat-password\"\r\n              type=\"password\"\r\n              placeholder=\"Repeat password\"\r\n            ></IonInput>\r\n          </IonItem>\r\n          <IonItem lines=\"none\">\r\n            <IonButton\r\n              className=\"button-register\"\r\n              onClick={signUp}\r\n              class=\"button\"\r\n            >\r\n              Sign Up\r\n            </IonButton>\r\n          </IonItem>\r\n          <IonItem lines=\"none\">\r\n            <IonButton\r\n              className=\"button-register\"\r\n              color=\"tertiary\"\r\n              onClick={signInWithGoogle}\r\n            >\r\n              Connect With Google\r\n            </IonButton>\r\n          </IonItem>\r\n          <IonItem lines=\"none\">\r\n            <IonLabel class=\"to-login\">\r\n              Already have account? <a href=\"/login\">Login Here</a>\r\n            </IonLabel>\r\n          </IonItem>\r\n        </section>\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n"]},"metadata":{},"sourceType":"module"}